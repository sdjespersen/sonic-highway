(self["webpackChunk_canva_web"] = self["webpackChunk_canva_web"] || []).push([[35024],{

/***/ 738083:
function(_, __, __webpack_require__) {__webpack_require__.n_x = __webpack_require__.n;const __web_req__ = __webpack_require__;__web_req__(813110);self._7ccc7343da2ae983607b3819c7bc1f93 = self._7ccc7343da2ae983607b3819c7bc1f93 || {};(function(__c) {var EH=__c.EH;var Jc=__c.Jc;var Q=__c.Q;var uu=__c.uu;var P=__c.P;var ix=__c.ix;var Xt=__c.Xt;var D=__c.D;var E=__c.E;
var U4=function(a,b){switch(b.reference.type){case 0:const c=a.hT(b.reference.Fi);a=a.PW(b.reference.Ni);return c!=null&&a!=null;case 1:return a.hT(b.reference.Fi)!=null;case 2:return a.PW(b.reference.Ni)!=null;case 3:return!1;default:throw new E(b.reference);}},VWb=function(a,b,c){switch(c.type){case "invalid":return!1;case "canonical":if(c.la.length>0)return!1;a=a.SG(c.TZ.slice(1).trim());return a.result!=="success"?!1:__c.JD(new __c.MD,a.ZI).filter(d=>{switch(d.type){case 0:return U4(b,d);case 1:return U4(b,
d.start)&&U4(b,d.end);default:throw new E(d);}}).length>0;default:throw new E(c);}},WWb=function(a,b,c,d){const e=[];for(const k of c)for(const l of d){c=k.xa;var f=l.column,g=a.layout.cells.get(c,f);if(!g||(k.boundary==="start"?g.span.bc===c:g.span.bd===c))if(c=b.get(`${f.id}:${c.id}`),c=k.boundary==="start"?c===null||c===void 0?void 0:c.Ba:c===null||c===void 0?void 0:c.Na){g=e[e.length-1];f=(f=a.layout.cols.next(f))?{column:f,boundary:"start"}:{column:D(a.layout.cols.last()),boundary:"end"};var h;
if(h=g)h=g.Rpa,h=h.column===l.column&&h.boundary===l.boundary;h&&(h=g.rXa,h=h.xa===k.xa&&h.boundary===k.boundary);h&&g.color===c.color&&g.weight===c.weight&&g.yc===c.yc&&g.yc===0?g.Rpa=f:e.push({rXa:k,gsb:l,Rpa:f,color:c.color,weight:c.weight,yc:c.yc})}}return e},XWb=function(a,b,c,d,e){const f=[];for(const l of d)for(const m of c){var g=m.xa,h=l.column;d=a.layout.cells.get(g,h);if(!d||(l.boundary==="start"?d.span.Wb===h:d.span.Qc===h))if(d=b.get(`${h.id}:${g.id}`),(d=l.boundary==="start"?d===null||
d===void 0?void 0:d.Aa:d===null||d===void 0?void 0:d.Va)&&(l.boundary!=="start"||e(g,h)!==1)){h=f[f.length-1];g=(g=a.layout.rows.next(g))?{xa:g,boundary:"start"}:{xa:D(a.layout.rows.last()),boundary:"end"};var k;if(k=h)k=h.IIa,k=k.column===l.column&&k.boundary===l.boundary;k&&(k=h.Upa,k=k.xa===m.xa&&k.boundary===m.boundary);k&&h.color===d.color&&h.weight===d.weight&&h.yc===d.yc&&h.yc===0?h.Upa=g:f.push({IIa:l,tsb:m,Upa:g,color:d.color,weight:d.weight,yc:d.yc})}}return f},YWb=function(a,b,c,d,e){const f=
a.iZa.M9a(c,b.layout.rows.last(),b.layout.cols.last());a=(q,r)=>{const t=f.get(q)||0,w=f.get(r)||0;return t<=w?q:r};const g=new Map;if(d.length===0||e.length===0)return g;var h=[],k=b.layout.cols.fc(e[0].column);k&&h.push({column:k,boundary:"start"});h.push(...e);(e=b.layout.cols.next(e[e.length-1].column))&&h.push({column:e,boundary:"start"});e=[];(k=b.layout.rows.fc(d[0].xa))&&e.push({xa:k,boundary:"start"});e.push(...d);(d=b.layout.rows.next(d[d.length-1].xa))&&e.push({xa:d,boundary:"start"});
for(const q of h){h=(d=q.boundary==="start"?q.column:void 0)?b.layout.cols.fc(d):b.layout.cols.last();for(const r of e){var l=r.boundary==="start"?r.xa:void 0;k=l?b.layout.rows.fc(l):b.layout.rows.last();var m=d&&l&&c.get(`${d.id}:${l.id}`),n=d&&k&&c.get(`${d.id}:${k.id}`);l=h&&l&&c.get(`${h.id}:${l.id}`);var p=h&&k&&c.get(`${h.id}:${k.id}`);k=q.boundary==="end"?l===null||l===void 0?void 0:l.Va:m===null||m===void 0?void 0:m.Aa;m=r.boundary==="end"?n===null||n===void 0?void 0:n.Na:m===null||m===void 0?
void 0:m.Ba;n=q.boundary==="end"?p===null||p===void 0?void 0:p.Va:n===null||n===void 0?void 0:n.Aa;l=r.boundary==="end"?p===null||p===void 0?void 0:p.Na:l===null||l===void 0?void 0:l.Ba;p=__c.RDa({Ba:n,Na:k,Aa:l,Va:m},a);let t;switch(p){case "blockStart":t=n;break;case "blockEnd":t=k;break;case "inlineStart":t=l;break;case "inlineEnd":t=m;break;default:t=void 0}const {height:w,width:u}=(t===null||t===void 0?void 0:t.yc)===1?{height:t.weight,width:t.weight}:{height:Math.max((l===null||l===void 0?void 0:
l.weight)||0,(m===null||m===void 0?void 0:m.weight)||0),width:Math.max((n===null||n===void 0?void 0:n.weight)||0,(k===null||k===void 0?void 0:k.weight)||0)};g.set(V4(q,r),__c.mE(p,w/2,u/2))}}return g},ZWb=function(a,b,c,d,e,f){if(d.length===0||e.length===0)return[];const g=WWb(b,c,d,e);f=XWb(b,c,d,e,f);const h=YWb(a,b,c,d,e),k=a.Leb(b),l=a.heb(b),m=b.direction==="rtl";a=g.map(n=>{var p,q,r=n.gsb,t=n.Rpa,w=n.rXa;const u=n.color,x=n.weight;n=n.yc;const y=m?-1:1,A=(p=h.get(V4(r,w)))===null||p===void 0?
void 0:p.Va;p=(q=h.get(V4(t,w)))===null||q===void 0?void 0:q.Aa;if(A!=null&&p!=null){q=D(k.get(w.xa));var z=D(l.get(r.column));r=D(l.get(t.column));w=w.boundary==="start"?q.start:q.end;q=z.start;t=t.boundary==="start"?r.start:r.end;return{color:u,weight:x,yc:n,p1:new Xt(q+A*y,w),p2:new Xt(t+p*y,w),...__c.rE((t-q)*y,n*x,A)}}}).filter(__c.wb);return[...f.map(n=>{var p,q,r=n.IIa,t=n.tsb,w=n.Upa;const u=n.color,x=n.weight;n=n.yc;const y=(p=h.get(V4(r,t)))===null||p===void 0?void 0:p.Na;p=(q=h.get(V4(r,
w)))===null||q===void 0?void 0:q.Ba;if(y!=null&&p!=null){q=D(l.get(r.column));var A=D(k.get(t.xa));t=D(k.get(w.xa));r=r.boundary==="start"?q.start:q.end;q=A.start;w=w.boundary==="start"?t.start:t.end;return{color:u,weight:x,yc:n,p1:new Xt(r,q+y),p2:new Xt(r,w+p),...__c.rE(w-q,n*x,y)}}}).filter(__c.wb),...a]},$Wb=function(a){const b=[];a=a.filter(c=>c.weight!==0&&c.color!=null);a=__c.Bd(a,c=>c.weight);a=Array.from(a.entries()).sort(([c],[d])=>c-d);for(const [c,d]of a){a=__c.Bd(d,e=>`${e.Uk}_${e.Vk}`);
for(const [,e]of a){const {Vk:f,Uk:g}=e[0];a=__c.Bd(e,h=>h.color);for(const [h,k]of a)b.push({weight:c,color:h,lines:k,Uk:g,Vk:f})}}return b},aXb=function(a,b,c,d){var e=__c.ysb;const f=b.get().flatMap(k=>a.layout.rows.last()===k?[{xa:k,boundary:"start"},{xa:k,boundary:"end"}]:[{xa:k,boundary:"start"}]),g=c.get().flatMap(k=>a.layout.cols.last()===k?[{column:k,boundary:"start"},{column:k,boundary:"end"}]:[{column:k,boundary:"start"}]),h=new Map;for(const k of b.get())for(const l of c.get())b=l&&k?
e.iZa.Epb(a,l,k):void 0,b&&h.set(`${l.id}:${k.id}`,b);c=ZWb(e,a,h,f,g,d);return $Wb(c)},W4=function(){const [a]=(0,__c.fc)(()=>ix());return a},bXb=function(a){switch(a){case 2:return P("ibdecg");case 7:return P("446quA");case 5:return P("j1fbqg");case 1:return P("O5i4AQ");case 6:return P("C0VHsg");case 4:return P("9ND0kg");case -1:return P("RWqnLA");case 9:return P("nQR/7w");case -2:return P("P23rtA");case 3:return P("+IXmVg");default:throw new E(a);}},cXb=function(a,b,c){const d=[a];for(;a!=null&&
a!==b;)(a=c.next(a))&&d.push(a);return d},dXb=function(a){const b=a.direction==="rtl"?-(0,__c.Bsb)(a)/2:-(0,__c.zsb)(a)/2,c=-(0,__c.Asb)(a)/2,d=a.width+(0,__c.zsb)(a)/2+(0,__c.Bsb)(a)/2;a=a.height+(0,__c.Asb)(a)/2+(0,__c.Csb)(a)/2;return uu({top:0,left:0,width:d,height:a,rotation:0}).translate(b,c)},eXb=function(a){return b=>({type:"react",node:(0,__c.N)(a,{...b})})},gXb=function(a){var b;const c=a.OA;var d=a.content;const e=a.context;a=a.vq;__c.C((d===null||d===void 0?void 0:(b=d.Dg)===null||b===
void 0?void 0:b.type)==="formula");b=d.Zk;const f={type:"dom",render:h=>h.innerText=""};switch(b.type){case 9:d=f;break;case 6:var g;d=(g=c.Ika)===null||g===void 0?void 0:g.call(c,{content:__c.le(__c.m4a,{...__c.mdb,value:b.value}),context:e,vq:a});break;case 1:case 3:case 4:case 2:case 7:case 8:d=fXb(c,e,d.DB,d.Zk.type);break;case 0:d={type:"react",node:X4(__c.HR,{label:bXb(b.error),children:X4(__c.ly,{width:"full",display:"flex",justifyContent:"center",children:X4(__c.Yzb,{tone:"critical"})})})};
break;default:throw new E(b);}return d!==null&&d!==void 0?d:f},fXb=function(a,b,c,d){var e;return(e=a.Lka)===null||e===void 0?void 0:e.call(a,{context:b,value:c,valueType:d})},jXb=function(a){const b=a.OA,c=a.Xf,d=a.btb,e=a.Ab;b.Lka=f=>__c.QKa({...f,Ab:e});b.zFa=f=>gXb({...f,OA:b});b.Ika=eXb(hXb({Xf:c,XR:void 0}));b.BFa=iXb(d,e);b.CFa=eXb(f=>X4(Y4,{...f,Ab:e}))},kXb=function({label:a,eb:b,width:c,height:d,scale:e,RIa:f}){return X4("div",{style:{width:c,height:d,transform:`scale(${e})`},className:"bx74uQ",
children:Z4(__c.iy,{className:$4("ivlMMQ",a5(f)),size:"small",alignment:"center",children:[b&&X4(b,{size:"small"}),a]})})},a5=function(a){return{_2BX0vg:a==="primary-default",JfW_Cg:a==="primary-low",isMgNg:a==="primary-active",xwWDeQ:a==="secondary-default",w0EyUQ:a==="secondary-low",_8p5AIA:a==="secondary-active"}},mXb=function({Ed:a,XNa:b,scale:c,cq:d,fq:e,N2a:f}){const g=b5(()=>{const m=d===null||d===void 0?void 0:d.get();if(m!=null&&m.length!==0)return new __c.aE(m)},[d]),h=e(1),k=e(c),l={ssE9Tg:!a,
OkifGQ:a};return X4(__c.jy,{lr:"light",light:"light",vu:"light",dark:"light",children:m=>X4("div",{className:$4("ze9QCQ",l,m.className),style:{width:k,height:k},children:X4("div",{style:{width:h,height:h,transform:`scale(${c})`},className:$4("N7J3UA",l),ref:g===null||g===void 0?void 0:g.jn,children:X4(__c.LR,{className:$4("m8CFdg",l,{G6wL4w:f,W_E0wA:b}),ariaLabel:P("ruWN9A"),children:X4(lXb,{size:"tiny"})})})})})},oXb=function(){const a=new nXb,b=new __c.lS,c=c5(f=>{const {scale:g=1,SNa:h,size:k=
"small",N2a:l=!0}=f,m=d5(n=>a.fq({scale:n,size:k,oua:h}),[k,h]);return X4(mXb,{...f,scale:h?Math.max(g,h):g,Ed:f.sheet.direction==="rtl",XNa:f.selection!=null&&a.Shb(f.sheet,f.selection),fq:m,N2a:l})}),d=c5(f=>{const {scale:g=1,SNa:h,size:k="small",sheet:l,selection:m,kqb:n}=f,p=d5(u=>a.fq({scale:u,size:k,oua:h}),[k,h]),q=h?Math.max(g,h):g,r=d5(u=>m!=null&&a.sya(m).has(u),[m]),t=d5(u=>m!=null&&a.Lfb(l,m).has(u),[l,m]),w=d5(u=>{const x=n!=null&&l.layout.cols.cf(u,n.Wb)>=0&&l.layout.cols.cf(u,n.Qc)<=
0;return r(u)?x?"secondary-active":"primary-active":t(u)?x?"secondary-low":"primary-low":x?"secondary-default":"primary-default"},[l,n,t,r]);return X4(e5,{...f,rd:g,Md:q,fq:p,MF:w,CG:b})}),e=c5(f=>{const {scale:g=1,SNa:h,size:k="small",sheet:l,selection:m,kqb:n}=f,p=d5(u=>a.fq({scale:u,size:k,oua:h}),[k,h]),q=h?Math.max(g,h):g,r=d5(u=>m!=null&&a.uya(m).has(u),[m]),t=d5(u=>m!=null&&a.Mfb(l,m).has(u),[l,m]),w=d5(u=>{const x=n!=null&&l.layout.rows.cf(u,n.bc)>=0&&l.layout.rows.cf(u,n.bd)<=0;return r(u)?
x?"secondary-active":"primary-active":t(u)?x?"secondary-low":"primary-low":x?"secondary-default":"primary-default"},[l,n,t,r]);return X4(f5,{...f,rd:q,Md:g,fq:p,MF:w,CG:b})});return{n3a:c,m3a:d,o3a:e}},pXb=function(a){const b=a.Sq,c=()=>null;return __c.sx(d=>X4(g5,{...d,Sq:b,$h:c}))},qXb=function({sheet:a,Y:b,range:c,je:d}){h5(()=>i5(()=>{if(d.current!=null){var e,f=(e=b===null||b===void 0?void 0:b.get())!==null&&e!==void 0?e:1;e=a.direction==="rtl";e=c?a.Aa(c.Wb)*f*(e?1:-1):0;var g=c?-a.Ba(c.bc)*
f:0;d.current.style.transform=`translate(${e}px, ${g}px)`;d.current.style.width=`${a.width*f}px`;d.current.style.height=`${a.height*f}px`}}),[a,c,d,b])},tXb=function({onScroll:a}){const b=new rXb(a);return{GD:b,uka:c5(c=>X4(sXb,{sheet:c.sheet,GD:b,children:c.children}))}},wXb=function(a){const b=a.Sq,c=a.Ff,d=a.jZa,e=({children:k})=>k,{GD:f,uka:g}=tXb({onScroll:a.onScroll});class h extends uXb{get BM(){const k=this.props.qa.Ku;switch(k){case "screen":return g;case "print":return e;default:throw new E(k);
}}componentDidMount(){d.TYa(this.props.item,{$b:this.props.$b,qa:this.props.qa})}componentWillUnmount(){d.D8a(this.props.item,{$b:this.props.$b,qa:this.props.qa})}render(){d.TYa(this.props.item,{$b:this.props.$b,qa:this.props.qa});return X4(vXb,{...this.props,Y:this.Y,Sq:b,BM:this.BM,$h:this.$h,jZa:d,GD:f})}constructor(...k){super(...k);this.Y=j5(()=>{const l=this.props.item;var m=this.props.qa,n=m.Ku;m=m.zoom;switch(n){case "screen":return m;case "print":n=d.Peb(l);if(!n)return 1;({width:n}=new __c.BE(l,
n.$b,{zoom:m}));return n/l.config.width;default:throw new E(n);}});this.$h=c5(l=>X4("div",{className:"wKvivQ",children:X4(__c.YKa,{...this.props,...l,Ff:c})}))}}return{h5a:h,GD:f}},xXb=function(a,b){if(b!=null&&b.Wb!=null&&b.bc!=null&&b.Qc!=null&&b.bd!=null){var c=a.Aa(b.Wb),d=a.Ba(b.bc),e=a.Aa(b.Qc)+b.Qc.width-c;a=a.Ba(b.bd)+b.bd.height-d;return uu({top:d,left:c,width:e,height:a})}},zXb=function(a){const b=a.Sq,c=()=>null;return d=>X4(yXb,{...d,Sq:b,$h:c})},DXb=function(a){const b={transform:"translate(-1000px, -1000px) scale(0)"},
c={gIa:b,Kw:b,Pa:{},Fo:{}},d=k5(()=>a.WA.style||c,h=>{var k;Object.assign(a.K9.style,h.gIa);Object.assign(a.UM.style,h.Kw);Object.assign(a.WE.style,h.Pa);Object.assign(a.aF.style,h.Fo);h=h===null||h===void 0?void 0:(k=h.Pa)===null||k===void 0?void 0:k.textDecoration;a.WE.classList.toggle("OQx3PQ",h==="underline");a.WE.classList.toggle("_99ezUA",h==="line-through");a.WE.classList.toggle("kppAqQ",h==="underline line-through")},{fireImmediately:!0,equals:AXb}),e=k5(()=>a.hta,h=>{a.WE.classList.toggle("_84KvRA",
!h);a.K9.classList.toggle("_84KvRA",!h);a.UM.classList.toggle("TL_RLA",!h)},{fireImmediately:!0}),f=k5(()=>a.renderer,h=>{a.x$&&(h===null||h===void 0?void 0:h.type)!=="react"?(a.x$=void 0,a.O4.remove()):a.aF.innerHTML="";switch(h===null||h===void 0?void 0:h.type){case "react":a.x$=BXb(h.node,a.O4);a.aF.appendChild(a.O4);break;case "dom":h.render(a.aF);break;case void 0:break;default:throw new E(h);}a.dva()},{fireImmediately:!0}),g=CXb?k5(()=>a.Era,h=>{a.WE.classList.toggle("qxD1GA",h)},{fireImmediately:!0}):
void 0;return()=>{d();e();f();g===null||g===void 0||g()}},AXb=function(a,b){return JSON.stringify(a)===JSON.stringify(b)},FXb=function(a){const b=a.PA,c=a.PD,d=a.kE,e=a.g2a,f=a.No,g=new EXb(c),h=(k,l)=>f?VWb(f,k,l):!1;return k=>X4(l5,{...k,KO:h,kE:d,PD:c,PA:b,Gsa:g,g2a:e===null||e===void 0?void 0:e.get()})},V4=(a,b)=>`${a.column.id}-${a.boundary}:${b.xa.id}-${b.boundary}`,hXb=({Xf:a,XR:b})=>c=>(0,__c.N)(__c.Esb,{...c,Xf:a,XR:b}),m5=__webpack_require__(443763),GXb=m5.Fragment,X4=m5.jsx,Z4=m5.jsxs;var HXb=__webpack_require__(358579).Z;var IXb=__webpack_require__,JXb=IXb(993864),$4=IXb.n_x(JXb)();var c5=__webpack_require__(446474).Pi;var n5=__webpack_require__(875604),o5=n5.Component,uXb=n5.PureComponent,d5=n5.useCallback,h5=n5.useEffect,KXb=n5.useLayoutEffect,b5=n5.useMemo,p5=n5.useRef,LXb=n5.useState;var q5=__webpack_require__(635872),r5=q5.Om,MXb=q5.kq,NXb=q5.YN;var s5=__webpack_require__(519427),t5=s5.action,i5=s5.autorun,u5=s5.comparer,j5=s5.computed,OXb=s5.createAtom,v5=s5.observable,k5=s5.reaction,PXb=s5.untracked;var w5=__webpack_require__(46239).gn;var BXb=__webpack_require__(36281).createPortal;var QXb=c5(a=>{var b,c,d=a.sheet.direction==="rtl";d={H2wykw:!d,UweldA:d};const [e]=LXb(()=>ix()),f={get:d5(()=>{var g;const h=e===null||e===void 0?void 0:(g=e.current)===null||g===void 0?void 0:g.getBoundingClientRect();var k,l;g={top:0,left:0,width:(k=h===null||h===void 0?void 0:h.width)!==null&&k!==void 0?k:0,height:(l=h===null||h===void 0?void 0:h.height)!==null&&l!==void 0?l:0};return uu(g)},[e])};return Z4("div",{className:$4("nMvVqA",d),children:[Z4("div",{ref:HXb(a.je,e),className:"_0YOFPg",
children:[X4(a.Sq,{...a,viewport:f}),X4("div",{className:$4("Gdl7fQ",d),children:(c=a.UEa)===null||c===void 0?void 0:(b=c.get())===null||b===void 0?void 0:b.map((g,h)=>X4(g,{},h))})]}),a.CFb==="visible"&&Z4(GXb,{children:[X4("div",{className:$4("_32sKQw",d),children:X4(a.e5a,{...a})}),X4("div",{className:$4("xdIsTQ",d),children:X4(a.i5a,{...a})}),X4("div",{className:$4("rsTRSA",d),children:X4(a.g5a,{...a})})]})]})}),RXb=c5(a=>{a=a.content;__c.v(a.type==="text2"||a.type==="text3");switch(a.type){case "text2":return a.value.aa;
case "text3":return __c.Rq.va(a.value).cells.aa();default:throw new E(a);}});var iXb=(a,b)=>__c.CKa((c,d)=>{const e=c.content;c=c.context;if(e.value.isEmpty)for(;d.lastChild;)d.lastChild.remove();else({wh:c}=__c.pg(__c.Yg,c.attrs)),c==="wrap"&&(d=d.appendChild(document.createElement("div")),d.className="dt4Dlg"),a.render({container:d,text:e.value,Qa:void 0,writingMode:1,Kd:"start",ah:SXb(e,c),Ab:b})}),SXb=r5((a,b)=>{if(b==="wrap")return[];a=a.value.aa.split("\n").map(c=>c.length+1);a.pop();return a},{equals:u5.structural});var Y4=class extends o5{static A(a){Q(a,{wh:j5})}get wh(){return __c.pg(__c.Yg,this.props.context.attrs).wh}render(){var a=this.props.content;const b=this.props.context;if(a.value.isEmpty)return null;a=X4(this.props.$h,{content:a,xa:b.container.xa,col:b.container.column,wh:this.wh});return this.wh==="wrap"?X4("div",{className:"dt4Dlg",children:a}):a}constructor(...a){super(...a);Y4.A(this)}};Y4=w5([Jc],Y4);var nXb=class{fq({size:a,scale:b,oua:c}){b=c?Math.max(c,b):b;return a==="large"?__c.SV*b:__c.Ryb*b}constructor(){this.Shb=r5((a,b)=>{var c,d;b=b.get();return b!=null&&a.layout.rows.count()===(((c=b.rows)===null||c===void 0?void 0:c.size)||0)&&a.layout.cols.count()===(((d=b.columns)===null||d===void 0?void 0:d.size)||0)});this.sya=MXb(a=>{var b;return new Set(((b=a.get())===null||b===void 0?void 0:b.columns)||[])},{equals:__c.Br});this.uya=MXb(a=>{var b;return new Set(((b=a.get())===null||b===void 0?
void 0:b.rows)||[])},{equals:__c.Br});this.Lfb=r5((a,b)=>{var {cells:c}=b.get()||{};if(!c)return new Set;if(this.uya(b).size>0)return new Set(a.layout.cols);b=this.sya(b);const d=new Set;for(const e of c){c=a.layout.cells.get(e.xa,e.column);for(const f of cXb(c?c.span.Wb:e.column,c?c.span.Qc:e.column,a.layout.cols))(b.size===0||b.has(f))&&d.add(f)}return d},{equals:__c.Br});this.Mfb=r5((a,b)=>{var {cells:c}=b.get()||{};if(!c)return new Set;if(this.sya(b).size>0)return new Set(a.layout.rows);b=this.uya(b);
const d=new Set;for(const e of c){c=a.layout.cells.get(e.xa,e.column);for(const f of cXb(c?c.span.bc:e.xa,c?c.span.bd:e.xa,a.layout.rows))(b.size===0||b.has(f))&&d.add(f)}return d},{equals:__c.Br})}};var TXb=parseInt("4px",10)||4,e5=class extends o5{static A(a){Q(a,{Ed:j5,Fr:j5,i6:j5})}get Ed(){return this.props.sheet.direction==="rtl"}get Fr(){var a;const b=(a=this.props.cq)===null||a===void 0?void 0:a.get();if(b!=null&&b.length!==0)return new __c.aE(b)}get i6(){var a,b,c;return(b=(c=this.props).$qa)===null||b===void 0?void 0:(a=b.call(c))===null||a===void 0?void 0:a.get()}render(){return X4(__c.jy,{lr:"light",light:"light",vu:"light",dark:"light",children:this.S8a})}constructor(...a){super(...a);
this.onMouseMove=(e5.A(this),t5(b=>{const {onMouseMove:c,sheet:d,rd:e=1}=this.props;c===null||c===void 0||c(b,d,"column",e)}));this.onMouseLeave=t5(b=>{var c,d;(c=(d=this.props).onMouseLeave)===null||c===void 0||c.call(d,b)});this.QWa=(b,c,d)=>{const {sheet:e,fq:f,MF:g,MFb:h,rd:k=1,Md:l=1}=this.props,m={jNbTIg:!this.Ed,gtA7Dw:this.Ed},n=(d===null||d===void 0?0:d.sticky)?this.Ed?{right:0}:{left:0}:void 0;var p;const q=(d===null||d===void 0?0:d.sticky)?(p=this.i6)!==null&&p!==void 0?p:n:void 0;let r=
-1;return Z4("div",{style:q,className:$4("Vt2_4w",m,{Tn3nUw:d===null||d===void 0?void 0:d.sticky}),onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,children:[e.layout.cols.map(t=>{var w;r++;if(!(b&&e.layout.cols.cf(t,b)<0||c&&e.layout.cols.cf(t,c)>0))return X4(UXb,{col:t,label:__c.FA(r),eb:h===null||h===void 0?void 0:(w=h.get())===null||w===void 0?void 0:w.get(t),fq:f,MF:g,rd:k,Md:l},t.id)}),(d===null||d===void 0?void 0:d.sticky)&&X4("div",{style:{width:TXb*k},className:$4("HBvlug","ru3tFQ",
m)})]})};this.S8a=b=>{var c;const d=this.props.sheet,e=d.view.freeze.KI?d.layout.Wd.get(d.view.freeze.KI):void 0,f={jNbTIg:!this.Ed,gtA7Dw:this.Ed};return Z4("div",{ref:(c=this.Fr)===null||c===void 0?void 0:c.jn,className:$4("xhBZaw",f,b.className),children:[e&&this.QWa(void 0,e,{sticky:!0}),this.QWa(e?d.cols.next(e):void 0)]})}}};e5=w5([Jc],e5);
var f5=class extends o5{static A(a){Q(a,{Ed:j5,Fr:j5,i6:j5})}get Ed(){return this.props.sheet.direction==="rtl"}get Fr(){var a;const b=(a=this.props.cq)===null||a===void 0?void 0:a.get();if(b!=null&&b.length!==0)return new __c.aE(b)}get i6(){var a,b,c;return(b=(c=this.props).$qa)===null||b===void 0?void 0:(a=b.call(c))===null||a===void 0?void 0:a.get()}render(){return X4(__c.jy,{lr:"light",light:"light",vu:"light",dark:"light",children:this.Upb})}constructor(...a){super(...a);this.onMouseMove=(f5.A(this),
t5(b=>{const {onMouseMove:c,sheet:d,Md:e=1}=this.props;c===null||c===void 0||c(b,d,"row",e)}));this.onMouseLeave=t5(b=>{var c,d;(c=(d=this.props).onMouseLeave)===null||c===void 0||c.call(d,b)});this.UWa=(b,c,d)=>{const {sheet:e,fq:f,MF:g,rd:h=1,Md:k=1}=this.props,l={jNbTIg:!this.Ed,gtA7Dw:this.Ed},m=(d===null||d===void 0?0:d.sticky)?{top:0}:void 0;var n;const p=(d===null||d===void 0?0:d.sticky)?(n=this.i6)!==null&&n!==void 0?n:m:void 0;let q=-1;return Z4("div",{style:p,className:$4("_93roJg",l,{Tn3nUw:d===
null||d===void 0?void 0:d.sticky}),onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,children:[e.rows.map(r=>{q++;if(!(b&&e.rows.cf(r,b)<0||c&&e.rows.cf(r,c)>0))return X4(VXb,{xa:r,label:`${q+1}`,MF:g,fq:f,rd:h,Md:k},r.id)}),(d===null||d===void 0?void 0:d.sticky)&&X4("div",{style:{height:TXb*k},className:$4("HBvlug","koz2Hg")})]})};this.Upb=b=>{var c;const d=this.props.sheet,e=d.view.freeze.QW?d.layout.we.get(d.view.freeze.QW):void 0,f={jNbTIg:!this.Ed,gtA7Dw:this.Ed};return Z4("div",{ref:(c=
this.Fr)===null||c===void 0?void 0:c.jn,className:$4("An9VeA",f,b.className),children:[e&&this.UWa(void 0,e,{sticky:!0}),this.UWa(e?d.rows.next(e):void 0)]})}}};f5=w5([Jc],f5);
var UXb=c5(a=>{const b=a.label,c=a.eb,d=a.col,e=a.MF,f=a.fq,g=a.rd;a=a.Md;const h=f(a),k=NXb(()=>e(d));return X4("div",{className:$4("_83Rssw","d2uLIA",a5(k)),style:{width:d.width*g,height:h},children:X4(kXb,{label:b,eb:c,width:d.width,height:f(1),scale:a,RIa:k})})}),VXb=c5(a=>{const b=a.label,c=a.xa,d=a.fq,e=a.MF,f=a.rd;a=a.Md;const g=d(f),h=NXb(()=>e(c));return X4("div",{className:$4("_83Rssw","JhBzyw",a5(h)),style:{width:g,height:c.height*a},children:X4(kXb,{label:b,width:d(1),height:c.height,
scale:f,RIa:h})})});var WXb='<svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><circle stroke="currentColor" cx="6" cy="6" r="5.5"/></svg>';var XXb='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle stroke="currentColor" cx="12" cy="12" r="9.25" stroke-width="1.5"/></svg>';var lXb=__c.AR({zp:WXb,medium:XXb});var g5=class extends o5{static A(a){Q(a,{He:j5.struct})}render(){const a=this.props.element;return X4(this.props.Sq,{sheet:a.ua.config,container:a,p9:"visible",cq:this.props.cq,Xu:this.props.Xu,Zu:this.props.Zu,Y:this.props.Y,He:this.He,$h:this.props.$h,gI:void 0})}get He(){return __c.NA(this.props.element.ua.Ya,this.props.Ye)}constructor(...a){super(...a);g5.A(this)}};g5=w5([Jc],g5);var YXb=class{constructor(){this.mha=new WeakMap;this.Peb=a=>this.mha.get(a);this.TYa=(a,b)=>{this.mha.set(a,b)};this.D8a=(a,b)=>{const c=this.mha.get(a);c&&c.qa===b.qa&&c.$b===b.$b&&this.mha.delete(a)}}};var x5=parseInt("4px",10)||4,ZXb=c5(({sheet:a,Y:b,range:c,Ww:d,Xw:e})=>{if(c!=null&&(d||e)){var f;b=(f=b===null||b===void 0?void 0:b.get())!==null&&f!==void 0?f:1;f=a.direction==="rtl";var g={ZJ0G6w:!f,dOI_jA:f};if(d&&e)return d=a.Ba(c.bd)+c.bd.height,a=a.Aa(c.Qc)+c.Qc.width,X4("div",{style:{top:d*b,width:a*b,height:x5*b},className:$4("aX8dhQ","VGcLng")});if(d)return c=a.Aa(c.Qc)+c.Qc.width,X4("div",{style:{width:x5*b,height:a.height*b,...(f?{right:c*b}:{left:c*b})},className:$4("aX8dhQ","gl1RPg",
g)});if(e)return c=a.Ba(c.bd)+c.bd.height,X4("div",{style:{top:c*b,width:a.width*b,height:x5*b},className:$4("aX8dhQ","VGcLng")})}});var y5=({sheet:a,range:b,Y:c,children:d})=>{const e=W4();qXb({sheet:a,Y:c,range:b,je:e});return X4("div",{ref:e,className:$4("nstn2A",a.direction==="rtl"?"NgnL2Q":"f8jAGQ"),children:d})},$Xb=({sheet:a,range:b,Y:c,children:d})=>{const e=W4();qXb({sheet:a,Y:c,range:b,je:e});a=a.direction==="rtl"?"NgnL2Q":"f8jAGQ";return X4("div",{className:$4("nstn2A",a,"_9sodyg"),children:X4("div",{ref:e,className:$4("nstn2A",a),children:d})})};var sXb=c5(({sheet:a,children:b,GD:c})=>{const d=d5(f=>{c.Qya(a,f)},[c,a]),e=d5(f=>{f!=null?c.HD.set(a,f):c.HD.delete(a)},[c,a]);return X4(__c.Sub,{direction:a.config.direction==="rtl"?"rtl":"ltr",onScroll:d,Lv:e,children:b})}),rXb=class{Qya(a,b){this.onScroll&&this.onScroll(a);this.u5.set(a,b)}constructor(a){this.onScroll=a;this.HD=new WeakMap;this.u5=v5.map(new Map,{deep:!1});this.scrollTo=t5((b,c)=>{b=this.HD.get(b);b===null||b===void 0||b.scrollTo({left:Math.floor(c)})})}};var vXb=c5(a=>{const b=a.item,c=a.cq,d=a.ng,e=a.measureRef,f=a.Y,g=a.UOa,h=a.$b,k=a.Xu,l=a.Zu,m=a.Sq,n=a.BM,p=a.$h,q=a.Ye,r=a.GD;a=b5(()=>__c.NA(b.Ya,q),[b,q]);const t=b5(()=>c5(({sheet:y,range:A,Ww:z,Xw:B})=>X4(y5,{sheet:y,range:A,Y:f,children:X4(ZXb,{sheet:y,Y:f,range:A,Ww:z,Xw:B})})),[f]),w=dXb(b.config),u=f.get(),x=Math.min(w.width*u,h.width);h5(()=>i5(()=>{var y=b.config.view.freeze.KI?b.config.layout.Wd.get(b.config.view.freeze.KI):void 0;if(y!=null)if(b.config.Aa(y)+y.width>x){if(y=r.HD.get(b))y.style.overflowX=
"hidden"}else if(y=r.HD.get(b))y.style.overflowX="scroll"}),[b,h.width,r,u,x]);return X4("div",{ref:e,className:"E8r86A",style:{width:x},children:X4(n,{sheet:b,children:X4("div",{ref:g,className:"cXTiJA",style:{width:w.width*u,height:w.height*u},children:X4("div",{className:"W1ir5A",children:X4(m,{container:d.hk(b),sheet:b.config,p9:"visible",cq:c,Y:f,Xu:k,Zu:l,He:a,$h:p,gI:t})})})})})});var aYb=c5(({page:a,range:b,xD:c})=>{const d=xXb(a.sheet,b);return X4("div",{className:"Gi9pfA",children:a.elements.map((e,f)=>d==null?c(e,f):__c.su(uu(e)).jq(d)&&c(e,f))})});var bYb=new __c.lS,z5=a=>__c.SV*a,cYb=()=>"primary-default",yXb=c5(({container:a,cq:b,Xu:c,Zu:d,o1:e,Y:f,viewport:g,Hrb:h,Sq:k,$h:l,xD:m,Ega:n,Txb:p,Gwb:q,Fwb:r})=>{const t=a.page,w=b5(()=>c5(({sheet:u,range:x,Ww:y,Xw:A})=>Z4(GXb,{children:[X4(y5,{sheet:t.sheet,range:x,Y:f,children:X4(ZXb,{sheet:u,Y:f,range:x,Ww:y,Xw:A})}),Z4($Xb,{sheet:t.sheet,range:x,Y:f,children:[p&&X4(p,{}),m&&X4(aYb,{page:t,xD:m,range:x}),r&&X4(r,{}),n&&n()]}),q&&x&&X4(y5,{sheet:t.sheet,range:x,Y:f,children:X4(q,{range:x})})]})),
[t,f,p,m,r,n,q]);return h?X4(dYb,{container:a,viewport:g,Y:f,cq:b,Xu:c,Zu:d,Sq:k,$h:l,gI:w}):X4(k,{sheet:t.sheet,container:a,p9:"hidden",cq:b,Xu:c,Zu:d,o1:e,Y:f,viewport:g,$h:l,gI:w})}),dYb=c5(a=>{const b=a.container,c=a.Y,d=a.viewport,e=a.cq,f=a.Xu,g=a.Zu,h=a.Sq,k=a.$h;a=a.gI;const l=b.page,m=l.sheet.direction==="rtl",n=p5(null),p=p5(null),q=p5(null);h5(()=>{const y=A5({sheet:l.sheet,Pha:!0,Qha:!0,Y:c,viewport:d});return k5(()=>y===null||y===void 0?void 0:y.get(),A=>{const z=n.current;if(A&&z){var B=
l.sheet.direction==="rtl",G;z.style.position=(G=A.position)!==null&&G!==void 0?G:"sticky";var H;z.style.top=(H=A.top)!==null&&H!==void 0?H:"0px";var K,I;B?z.style.right=(K=A.right)!==null&&K!==void 0?K:"0px":z.style.left=(I=A.left)!==null&&I!==void 0?I:"0px";var M;z.style.transform=(M=A.transform)!==null&&M!==void 0?M:""}})},[l.sheet,c,d]);h5(()=>{const y=A5({sheet:l.sheet,Pha:!1,Qha:!0,Y:c,viewport:d});return k5(()=>y===null||y===void 0?void 0:y.get(),A=>{const z=q.current;if(A&&z){var B;z.style.position=
(B=A.position)!==null&&B!==void 0?B:"sticky";var G;z.style.top=(G=A.top)!==null&&G!==void 0?G:"0px";var H;z.style.transform=(H=A.transform)!==null&&H!==void 0?H:""}})},[l.sheet,c,d]);h5(()=>{const y=A5({sheet:l.sheet,Pha:!0,Qha:!1,Y:c,viewport:d});return k5(()=>y===null||y===void 0?void 0:y.get(),A=>{const z=p.current;if(A&&z){var B=l.sheet.direction==="rtl",G;z.style.position=(G=A.position)!==null&&G!==void 0?G:"sticky";var H,K;B?z.style.right=(H=A.right)!==null&&H!==void 0?H:"0px":z.style.left=
(K=A.left)!==null&&K!==void 0?K:"0px";var I;z.style.transform=(I=A.transform)!==null&&I!==void 0?I:""}})},[l.sheet,c,d]);const r=d5((y,A,z)=>A5({sheet:y,Pha:A,Qha:z,Y:c,viewport:d}),[c,d]),t=b5(()=>r?()=>r(l.sheet,!0,!1):void 0,[r,l.sheet]),w=b5(()=>r?()=>r(l.sheet,!1,!0):void 0,[r,l.sheet]);var u;const x=(u=c===null||c===void 0?void 0:c.get())!==null&&u!==void 0?u:1;return Z4("div",{className:$4("OsKKIQ","cbOp6Q"),children:[X4("div",{className:"VDFv_A",children:X4(h,{sheet:l.sheet,container:b,p9:"hidden",
cq:e,Xu:f,Zu:g,o1:r,Y:c,viewport:d,$h:k,gI:a})}),X4("div",{ref:n,className:"_688KWg",children:X4(mXb,{Ed:m,XNa:!1,fq:z5,scale:x})}),X4("div",{ref:q,className:"m0cT1w",children:X4(e5,{sheet:l.sheet,rd:x,Md:x,fq:z5,MF:cYb,CG:bYb,$qa:t})}),X4("div",{ref:p,className:"zm537g",children:X4(f5,{sheet:l.sheet,rd:x,Md:x,fq:z5,MF:cYb,CG:bYb,$qa:w})})]})}),A5=({sheet:a,Pha:b,Qha:c,Y:d,viewport:e})=>j5(()=>{var f=e===null||e===void 0?void 0:__c.Cu(e.get()),g;const h=(g=d===null||d===void 0?void 0:d.get())!==null&&
g!==void 0?g:1;if(!f)return{};g={};f=new Xt(f.left,f.top);const k=a.direction==="rtl";g.position="relative";c&&(g.top="0px");b&&(k?g.right="0px":g.left="0px");g.transform=`translate(${b?f.x*h:0}px, ${c?f.y*h:0}px)`;return g});var EXb=class{constructor(a){this.PD=a;this.o8a=__c.YT;this.web=r5((b,c,d,e)=>{d=d.get();const f=new WeakMap;for(let t=0;t<d.length;t++){var g=d[t],h=this.qeb(b,c,g);if(h){switch(h){case "start":case "justify":var k=d[t+1];if(k==null||!EH(b,c,k))continue;break;case "center":k=d[t+1];if(k==null||!EH(b,c,k))continue;k=d[t-1];if(k==null||!EH(b,c,k))continue;break;case "end":k=d[t-1];if(k==null||!EH(b,c,k))continue;break;default:throw new E(h);}if(k=e(c,g)){var l=k.width+(h==="center"?0:this.o8a);if(!(g.width>
l)){switch(h){case "start":case "justify":h=b.Aa(g);k=h+l;break;case "center":k=b.Aa(g)+g.width/2;h=k-l/2;k+=l/2;break;case "end":k=b.Aa(g)+g.width;h=k-l;break;default:throw new E(h);}for(l=d.indexOf(g);l>=0;l--){var m=d[l],n=l-1<0||EH(b,c,d[l-1]),p;if(p=m===g||EH(b,c,m)){p=h;var q=k,r=b.Aa(m);p=p<r&&r<q}if(p&&n)f.set(m,1);else break}for(g=d.indexOf(g)+1;g<d.length;g++){l=d[g];if(m=EH(b,c,l))m=h,n=k,p=b.Aa(l),m=m<p&&p<n;if(m)f.set(l,1);else break}}}}}return f});this.qeb=(b,c,d)=>{var e,f;const g=
b.layout.cells.get(c,d);if(g&&(g.ref.content.ref||g.ref.Ha.ref)&&g.span.bc===g.span.bd&&g.span.Wb===g.span.Qc){var h=this.PD.Yw(b,c,d);b=this.PD.Uqa(b,c,d,__c.Zg({wh:void 0,textAlign:void 0}));var {wh:k,textAlign:l}=__c.pg(__c.Yg,b);if(k==="overflow")return __c.DKa(l,(e=g.ref.content.ref)===null||e===void 0?void 0:e.type,(f=g.ref.Ha.ref)===null||f===void 0?void 0:f.type,h?()=>h.Zk.type:void 0)}}}};var eYb=c5(function(a){const b=a.sheet;var c=a.xj;const d=a.ivb,e=a.Y,f=a.Gsa,g=a.feb;a=a.overflow;const h=W4();KXb(()=>i5(()=>{const p=D(h.current);var q;const r=(q=e===null||e===void 0?void 0:e.get())!==null&&q!==void 0?q:1;q=b.height;p.style.width=`${b.width*r}px`;p.style.height=`${q*r}px`}),[h,e,b]);const k=d5(p=>f.web(b,p,d,g),[f,b,d,g]);var l=d5((p,q)=>{var r,t;return(t=(r=k(p))===null||r===void 0?void 0:r.get(q))!==null&&t!==void 0?t:0},[k]);c=aXb(b,c,d,l);l=b.width;const m=b.height,n=b.direction===
"rtl";return X4("svg",{ref:h,role:"presentation",className:$4("c6a1eQ",{H_CtIQ:!n,_8_56PQ:n,_3NnFzw:a==="visible",JMH1ng:a==="hidden"}),viewBox:`0 0 ${l} ${m}`,strokeLinecap:"butt",strokeLinejoin:"miter",children:c.map(({lines:p,color:q,weight:r,Uk:t,Vk:w})=>X4("path",{stroke:q,strokeDasharray:t,strokeDashoffset:w,strokeWidth:r,d:p.map(({p1:u,p2:x})=>`M ${u.x} ${u.y} L ${x.x} ${x.y}`).join(" ")},`${q}-${r}-${t}-${w}`))})});var fYb=class{get size(){return this.yha}get([a,b]){return(a=this.kG.get(a))?a.get(b):void 0}has([a,b]){a=this.kG.get(a);return a==null?!1:a.has(b)}set([a,b],c){let d=this.kG.get(a);d==null&&(d=new Map,this.kG.set(a,d));d.set(b,c);this.yha++;return this}clear(){this.kG.clear();this.yha=0}delete([a,b]){const c=this.kG.get(a);if(c==null||!c.delete(b))return!1;this.yha--;c.size===0&&this.kG.delete(a);return!0}forEach(a){for(const [b,c]of this.kG)for(const [d,e]of c)a([b,d],e)}*[Symbol.iterator](){for(const [a,
b]of this.kG)for(const [c,d]of b)yield[[a,c],d]}constructor(){this.yha=0;this.kG=new Map}};var CXb=__c.Dw("285688d5",!1),C5=class extends o5{render(){const {xba:a,...b}=this.props,c=this.props.sheet;return Z4("div",{ref:this.lZa,className:$4("ZTz_iA",c.direction==="ltr"?"TA4X7w":"WvuqMw"),children:[(a===null||a===void 0?void 0:a.wHa)&&X4(B5,{...b,sheet:c,range:a.wHa.range,Ww:!0,Xw:!0,className:"_0C8M3w"}),(a===null||a===void 0?void 0:a.q2a)&&X4(B5,{...b,sheet:c,range:a.q2a.range,Ww:!1,Xw:!0,className:"_7n44yg"}),(a===null||a===void 0?void 0:a.$Na)&&X4(B5,{...b,sheet:c,range:a.$Na.range,
Ww:!0,Xw:!1,className:"fF5r6w"}),(a===null||a===void 0?void 0:a.d1a)&&X4(B5,{...b,sheet:c,range:a.d1a.range,Ww:!1,Xw:!1,className:"llILYw"})]})}componentDidMount(){const a=i5(()=>{var b=this.props,c=b.Y;b=b.sheet;const d=this.lZa.current;d&&(c=c?c.get():1,d.style.width=`${b.width*c}px`,d.style.height=`${b.height*c}px`)});__c.vc(this,[a])}constructor(...a){super(...a);this.lZa=ix()}};C5=w5([Jc],C5);
var B5=class extends o5{static A(a){Q(a,{cza:j5,bounds:j5})}get cza(){const a=this.props.viewport,b=this.props.Ww,c=this.props.Xw;return a==null||!b&&!c?a:j5(()=>{const d=__c.Cu(a.get());return uu({top:c?0:d.top,left:b?0:d.left,width:d.width,height:d.height})})}render(){const a=this.props.KO,b=this.props.sheet,c=this.props.container,d=this.props.range,e=this.props.gI,f=this.props.Ww,g=this.props.Xw;return Z4("div",{ref:this.pwa,className:$4("i0YQww",this.props.className),children:[X4("div",{ref:this.aVa,
className:"vUKoKg",children:X4("div",{ref:this.bVa,children:X4(D5,{KO:a,sheet:b,container:c,bounds:d,cq:this.props.cq,kE:this.props.kE,$h:this.props.$h,A_:this.props.A_,Y:this.props.Y,xj:this.xj,G7:this.G7,rT:this.rT})})}),X4(this.wka,{}),e&&X4(e,{sheet:b,range:d,Ww:f,Xw:g})]})}componentDidMount(){const a=i5(()=>{var g=this.props,h=g.Y,k=g.sheet;const l=g.range;var m=this.pwa.current;const n=this.aVa.current;g=this.bVa.current;h=h?h.get():1;const p=l?k.Aa(l.Qc)+l.Qc.width-k.Aa(l.Wb):k.width,q=l?k.Ba(l.bd)+
l.bd.height-k.Ba(l.bc):k.height;m&&(m.style.width=`${p*h}px`,m.style.height=`${q*h}px`);n&&(n.style.width=`${p*h}px`,n.style.height=`${q*h}px`);m=k.direction==="rtl";m=l?k.Aa(l.Wb)*h*(m?1:-1):0;k=l?-k.Ba(l.bc)*h:0;g&&(g.style.transform=`translate(${m}px, ${k}px)`)}),b=this.props.sheet;var c=this.props.o1;const d=this.props.Ww,e=this.props.Xw,f=d||e?c===null||c===void 0?void 0:c(b,d,e):void 0;c=i5(()=>{const g=this.pwa.current;if(g!=null){var h=d||e?"sticky":"relative",k=e?"0px":"unset",l=d?"0px":
"unset",m=d?"0px":"unset",n=b.direction==="rtl";if(f==null)g.style.position=h,g.style.top=k,g.style.left=n?"unset":l,g.style.right=n?m:"unset";else{const u=f.get();var p;g.style.position=(p=u.position)!==null&&p!==void 0?p:h;var q;g.style.top=(q=u.top)!==null&&q!==void 0?q:k;var r;g.style.left=n?"unset":(r=u.left)!==null&&r!==void 0?r:l;var t;g.style.right=n?(t=u.right)!==null&&t!==void 0?t:m:"unset";var w;g.style.transform=(w=u.transform)!==null&&w!==void 0?w:"unset"}}});__c.vc(this,[a,c])}get bounds(){const a=
this.props.sheet,b=this.props.range;if(a.layout.cols.empty||a.layout.rows.empty)return{Wb:void 0,Qc:void 0,bc:void 0,bd:void 0};var c,d,e,f;return{Wb:(c=b===null||b===void 0?void 0:b.Wb)!==null&&c!==void 0?c:a.layout.cols.first(),Qc:(d=b===null||b===void 0?void 0:b.Qc)!==null&&d!==void 0?d:a.layout.cols.last(),bc:(e=b===null||b===void 0?void 0:b.bc)!==null&&e!==void 0?e:a.layout.rows.first(),bd:(f=b===null||b===void 0?void 0:b.bd)!==null&&f!==void 0?f:a.layout.rows.last()}}constructor(...a){super(...a);
this.pwa=(B5.A(this),ix());this.aVa=ix();this.bVa=ix();this.rT=new gYb;this.jvb=j5(()=>[...this.xj.get().keys()].sort((b,c)=>this.props.sheet.layout.rows.cf(b,c)),{equals:__c.Fr()});this.hvb=j5(()=>[...this.G7.get().keys()].sort((b,c)=>this.props.sheet.layout.cols.cf(b,c)),{equals:__c.Fr()});this.wka=c5(()=>X4(this.props.d5a,{xj:this.jvb,ivb:this.hvb,feb:this.rT.neb,range:this.props.range}));this.xj=j5(()=>{var b;const c=this.props.sheet;var d=this.props.Y,e=(b=this.cza)===null||b===void 0?void 0:
b.get();if(e&&(e.height<=0||e.width<=0))return new Map;b=this.bounds;d=d.get();var f=50*d;const g=e?e.tl.y-f:b.bc?c.Ba(b.bc):0;e=e?e.br.y+f:b.bd?c.Ba(b.bd)+b.bd.height:0;f=new Map;for(let h=b.bc;h!=null&&b.bd!=null&&c.layout.rows.cf(h,b.bd)<=0;h=c.layout.rows.next(h)){const k=c.Ba(h);if(!(k+h.height<g)){if(k>e)break;f.set(h,k*d)}}return f},{equals:u5.shallow});this.G7=j5(()=>{var b;const c=this.props.sheet;var d=this.props.Y,e=(b=this.cza)===null||b===void 0?void 0:b.get();if(e&&(e.height<=0||e.width<=
0))return new Map;b=this.bounds;d=d.get();var f=50*d;const g=e?e.tl.x-f:b.Wb?c.Aa(b.Wb):0;e=e?e.br.x+f:b.Qc?c.Aa(b.Qc)+b.Qc.width:0;f=new Map;for(let h=b.Wb;h!=null&&b.Qc!=null&&c.layout.cols.cf(h,b.Qc)<=0;h=c.layout.cols.next(h)){const k=c.Aa(h);if(!(k+h.width<g)){if(k>e)break;f.set(h,k*d)}}return f},{equals:u5.shallow})}};B5=w5([Jc],B5);
var gYb=class{constructor(){this.cells=new fYb;this.yxa=(a,b,c)=>{let d=this.cells.get([a,b]);d==null&&(d=v5.box(void 0,{deep:!1}),this.cells.set([a,b],d));d.set(c);return()=>{const e=this.cells.get([a,b]);e===d&&(e.set(void 0),this.cells.delete([a,b]))}};this.neb=(a,b)=>{var c;let d=this.cells.get([a,b]);d==null&&(d=v5.box(void 0,{deep:!1}),this.cells.set([a,b],d));return(c=d.get())===null||c===void 0?void 0:c.oJa}}},D5=class extends o5{static A(a){Q(a,{lM:v5.shallow,Fr:j5,cHa:t5,E$:t5.bound})}get Fr(){var a;
const b=(a=this.props.cq)===null||a===void 0?void 0:a.get();if(b!=null&&b.length!==0)return new __c.aE(b)}render(){var a;return Z4("div",{ref:HXb(this.je,(a=this.Fr)===null||a===void 0?void 0:a.jn),children:[X4("div",{ref:this.ina,className:"_5YlOqQ"}),X4("div",{ref:this.kna,className:"_XCmKw"}),this.lM.map(b=>b.job)]})}componentDidMount(){const a=k5(()=>[this.props.sheet,this.props.G7.get(),this.props.xj.get()],([d,e,f],g)=>{[g]=g||[];d!==g&&(d=D(this.ina.current),g=D(this.kna.current),d.innerHTML=
"",g.innerHTML="",this.vDa.length=0,this.lM.length=0);this.cHa(e,f)},{fireImmediately:!0}),b=i5(()=>{var d=this.props,e=d.Y;d=d.sheet;const f=this.je.current;f&&(e=e?e.get():1,f.style.width=`${d.width*e}px`,f.style.height=`${d.height*e}px`)}),c=this.lM.map(d=>DXb(d));__c.vc(this,[b,a,...c])}cHa(a,b){const c=D(this.ina.current),d=D(this.kna.current),e=[],f=new Map;for(const g of this.vDa)b.has(g.xa)?f.set(g.xa,g):e.push(g);for(const [g,h]of b)b=f.get(g)||e.pop(),b||(b=new hYb(this.E$,g),c.appendChild(b.L9),
d.appendChild(b.N9),this.vDa.push(b)),b.update(h,g,a);for(const g of e)g.hide()}E$(a,b){const c=this.props.A_,d=this.props.sheet,e=this.props.container,f=this.props.rT;a=new iYb(this.props.KO,this.props.kE,this.props.$h,c(a,b),d,a,b,e,f.yxa,this.Nba,this.Mba);__c.vc(this,DXb(a));this.lM.push(a);return a}constructor(...a){super(...a);this.je=(D5.A(this),ix());this.ina=ix();this.kna=ix();this.vDa=[];this.lM=[];this.Nba=r5(b=>{const c=this.props.xj.get();return b==="first"?c.keys().next().value:[...c.keys()].pop()});
this.Mba=r5(b=>{const c=this.props.G7.get();return b==="first"?c.keys().next().value:[...c.keys()].pop()})}};D5=w5([Jc],D5);
var hYb=class{static A(a){Q(a,{update:t5})}update(a,b,c){[this.L9,this.N9].forEach(d=>{d.style.transform=`translateY(${a}px)`;d.classList.add("FPpqvg")});this.xa=b;for(const [d]of c)c=this.lM.get(d),c||(c=this.E$(d,b),this.lM.set(d,c),this.L9.appendChild(c.K9),this.N9.appendChild(c.UM)),c.update(b)}hide(){[this.L9,this.N9].forEach(a=>{a.style.transform="translate(-1000px, -1000px) scale(0)"})}constructor(a,b){this.E$=a;this.xa=b;this.L9=(hYb.A(this),document.createElement("div"));this.N9=document.createElement("div");
this.lM=new Map}},iYb=class{static A(a){Q(a,{x$:v5.ref,xa:v5.ref,Era:j5,update:t5,tu:j5,attrs:j5.struct,hta:j5,Kw:j5,renderer:j5,oJa:j5.struct})}get Era(){if(!CXb)return!1;const a=this.tu;return a==null||a.content.ref==null||a.content.ref.type!=="formula"?!1:this.KO(this.sheet,a.content.ref.value)}update(a){a!==this.xa&&(this.xa=a,this.WA.xa=a,this.cpa&&this.cpa(),this.cpa=this.yxa(this.xa,this.col,this))}get job(){return this.x$}get tu(){const a=this.sheet.layout.cells.get(this.xa,this.col);return a?
a.ref:void 0}get attrs(){const a=this.WA.attrs;return{wh:a===null||a===void 0?void 0:a.wh,textAlign:a===null||a===void 0?void 0:a.textAlign,direction:a===null||a===void 0?void 0:a.direction,link:a===null||a===void 0?void 0:a.link}}get hta(){var a=this.WA.span;if(!a)return!1;if(a.bc===a.bd&&a.Wb===a.Qc)return!0;var b=this.Nba("first");const c=this.Nba("last"),d=this.Mba("first"),e=this.Mba("last");if(!(b&&c&&d&&e))return!1;b=this.sheet.layout.rows.cf(a.bc,b)>=0&&this.sheet.layout.rows.cf(a.bc,c)<=
0?a.bc:b;a=this.sheet.layout.cols.cf(a.Wb,d)>=0&&this.sheet.layout.cols.cf(a.Wb,e)<=0?a.Wb:d;return b===this.xa&&a===this.col}get Kw(){const a=this.sheet,b=this.xa,c=this.col;if(!this.container)return{type:void 0,sheet:a,xa:b,column:c};switch(this.container.type){case "fixed-page":return this.container.ynb.Ld(c,b);case "sheet-item":return this.container.bza.Ld(c,b);case "sheet-element":return this.container.xrb.Ld(c,b);default:throw new E(this.container);}}get renderer(){const a=this.tu;if(a&&this.hta&&
(a.content.ref||a.Ha.ref))return this.kE({context:{container:this.Kw,attrs:this.attrs},vq:this.dva,$h:this.$h})}get oJa(){this.pJa.reportObserved();var a=PXb(()=>this.renderer);if(a&&(a=a.type==="react"?this.O4:this.aF,a.childNodes.length!==0&&(a=a.childNodes[0],a instanceof HTMLElement)))return{width:a.clientWidth,height:a.clientHeight}}constructor(a,b,c,d,e,f,g,h,k,l,m){var n,p,q,r,t,w;this.KO=a;this.kE=b;this.WA=d;this.sheet=e;this.col=f;this.container=h;this.yxa=k;this.Nba=l;this.Mba=m;this.K9=
(iYb.A(this),document.createElement("div"));this.UM=document.createElement("div");this.WE=document.createElement("div");this.aF=document.createElement("div");this.O4=document.createElement("div");this.pJa=OXb("content size atom");this.dva=t5(()=>this.pJa.reportChanged());this.xa=g;this.K9.className="_2JFriw";this.UM.className="imy9ug";this.WE.className=$4("pDMp7w",{_0yZ6Qg:((p=this.tu)===null||p===void 0?void 0:(n=p.content.ref)===null||n===void 0?void 0:n.type)!=="text3",qhF5uA:((r=this.tu)===null||
r===void 0?void 0:(q=r.content.ref)===null||q===void 0?void 0:q.type)!=="text3"&&((w=this.tu)===null||w===void 0?void 0:(t=w.content.ref)===null||t===void 0?void 0:t.type)!=="text2",qxD1GA:this.Era});this.aF.className="_30B9pw";this.WE.appendChild(this.aF);this.UM.appendChild(this.WE);this.O4.className="G7zH2w";this.cpa=k(this.xa,this.col,this);this.$h=u=>X4(c,{...u,vq:this.dva})}};var l5=class extends o5{static A(a){Q(a,{xba:j5})}render(){const {KO:a,sheet:b,container:c,cq:d,o1:e,kE:f,He:g,$h:h,viewport:k,gI:l,g2a:m=!1}=this.props;if(!b.layout.cols.empty&&!b.layout.rows.empty)return X4("div",{className:$4("SNkrHw",b.direction==="ltr"?"TA4X7w":"WvuqMw",{RaA0Nw:m}),...g,children:X4(C5,{KO:a,kE:f,$h:h,d5a:this.wka,A_:this.A_,sheet:b,container:c,cq:d,o1:e,Y:this.Y,viewport:k,gI:l,xba:this.xba})})}get xba(){var a=this.props.sheet;const b={},c=a.view.freeze.QW?a.layout.we.get(a.view.freeze.QW):
void 0,d=a.view.freeze.KI?a.layout.Wd.get(a.view.freeze.KI):void 0,e=a.layout.rows.first(),f=a.layout.rows.last(),g=a.layout.cols.first(),h=a.layout.cols.last();if(e!=null&&f!=null&&g!=null&&h!=null){var k=d?a.layout.cols.next(d):g;a=c?a.layout.rows.next(c):e;c&&d&&(b.wHa={range:{Wb:g,bc:e,Qc:d,bd:c}});c&&k&&(b.q2a={range:{Wb:k,bc:e,Qc:h,bd:c}});d&&a&&(b.$Na={range:{Wb:g,bc:a,Qc:d,bd:f}});a&&k&&(b.d1a={range:{Wb:k,bc:a,Qc:h,bd:f}});return b}}get Y(){return this.props.Y?this.props.Y:j5(()=>1)}constructor(...a){super(...a);
this.wka=(l5.A(this),c5(b=>{const {sheet:c,Gsa:d,Y:e,p9:f="hidden"}=this.props;return X4(y5,{sheet:c,range:b.range,Y:e,children:X4(eYb,{...b,sheet:c,Y:this.Y,Gsa:d,overflow:f})})}));this.A_=(b,c)=>new __c.WKa(this.props.PD,this.props.PA,this.props.sheet,b,c,this.Y,this.Xu,this.Zu);this.Xu=(b,c)=>{var d,e;return(d=(e=this.props).Xu)===null||d===void 0?void 0:d.call(e,this.props.sheet,b,c)};this.Zu=(b,c)=>{var d,e;return(d=(e=this.props).Zu)===null||d===void 0?void 0:d.call(e,this.props.sheet,b,c)}}};
l5=w5([Jc],l5);__c.cLa={Pgb:function(a){const b=a.Mo,c=a.Rd,d=a.qd,e=a.dn,f=a.PD,g=a.PA,h=a.HY;jXb({OA:a.OA,Xf:a.Xf,btb:a.lQ,Ab:a.Ab});const k=FXb({kE:h,PD:f,PA:g,No:void 0});b.Pka=zXb({Sq:k});c.xka=pXb({Sq:k});({h5a:a}=wXb({Sq:k,Ff:e(),jZa:new YXb}));d.Zq.Oka=a;const {n3a:l,o3a:m,m3a:n}=oXb();return{nFa:c5(p=>X4(QXb,{...p,container:void 0,Sq:k,g5a:l,i5a:m,e5a:n,$h:RXb}))}}};
}).call(self, self._7ccc7343da2ae983607b3819c7bc1f93);}

}])
//# sourceMappingURL=sourcemaps/0ad73bba9e812b33.js.map